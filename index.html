<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Dossier: Aristia Firlin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body class="flex items-center justify-center min-h-screen">

    <div id="flash-overlay"></div>

    <!-- Animasi Rasi Bintang Sagittarius Loading -->
    <div id="constellation-loader">
        <svg viewBox="0 0 200 200" width="180" height="180" class="mb-4">
            <g class="twinkle">
                <circle cx="100" cy="40" r="2" class="star" />
                <circle cx="120" cy="70" r="2" class="star" />
                <circle cx="110" cy="110" r="2" class="star" />
                <circle cx="70" cy="90" r="2" class="star" />
                <circle cx="150" cy="60" r="2" class="star" />
                <circle cx="140" cy="95" r="2" class="star" />
            </g>
            <path d="M100 40 L120 70 L110 110 L70 90 L120 70 M120 70 L150 60 L140 95 L110 110" fill="none" class="const-line" />
        </svg>
        <p class="text-[9px] uppercase tracking-[0.4em] opacity-60">Aligning Sagittarius...</p>
    </div>

    <!-- Modal Purge -->
    <div id="delete-modal" class="custom-modal">
        <div class="bg-[#f2ecd9] p-6 max-w-xs w-full border-t-8 border-red-900 text-center shadow-2xl relative z-50">
            <h3 class="font-bold uppercase text-[10px] tracking-widest mb-2">Penghancuran Berkas?</h3>
            <p class="text-[9px] mb-6 opacity-70">Log transmisi akan dihapus secara permanen.</p>
            <div class="flex gap-4">
                <button onclick="DossierSystem.closeModal()" class="flex-1 py-2 border border-black text-[9px] uppercase">Abort</button>
                <button onclick="DossierSystem.confirmPurge()" class="flex-1 py-2 bg-red-900 text-white text-[9px] uppercase">Execute</button>
            </div>
        </div>
    </div>

    <!-- Login Auth -->
    <div id="auth-module" class="scanning-active">
        <div id="scanning-line"></div>
        <div id="init-screen" class="terminal-container">
            <button class="init-btn" onclick="DossierSystem.showPin()">Access Archive</button>
        </div>
        <div id="pin-screen" class="terminal-container decode-interface">
            <input type="password" id="pin-field" maxlength="6" class="w-full bg-transparent border-b border-red-900 text-center text-4xl text-red-700 outline-none tracking-[0.5em] py-2" placeholder="******">
            <p class="text-[9px] mt-6 text-white/40 tracking-widest uppercase">Hint: 300326</p>
        </div>
    </div>

    <main class="paper-container">
        <div id="nav-l" class="nav-zone nav-left" onclick="DossierSystem.prev()"></div>
        <div id="nav-r" class="nav-zone nav-right" onclick="DossierSystem.next()"></div>

        <div id="module-viewport" class="flex-1 relative overflow-hidden">
            
            <!-- Halaman 0: Editorial -->
            <section class="page-module victorian-bg active" id="mod-0">
                <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
                    <div class="newspaper-fragment" style="top: 8%; right: 5%; transform: rotate(12deg); width: 100px; opacity: 0.8; box-shadow: 2px 2px 8px rgba(0,0,0,0.3);">
                        <h4>BREAKING</h4>
                        <p>Sinyal misterius terdeteksi dari sektor 17.</p>
                    </div>
                    <div class="washi-tape washi-pattern" style="top: 5%; right: 2%; transform: rotate(45deg); width: 60px;"></div>
                    <div class="pushpin" style="top: 10%; left: 15%;"></div>
                </div>

                <div class="torn-paper torn-bottom p-6 shadow-xl relative bg-[#f9f7f1] mt-8 mx-2 rotate-[-2deg] z-10">
                    <div class="washi-tape" style="top: -12px; left: 50%; transform: translateX(-50%) rotate(-2deg); width: 120px;"></div>
                    <div class="text-center mb-2 border-b-2 border-double border-black/20 pb-2">
                        <p class="text-[9px] uppercase tracking-[0.4em] opacity-50 font-serif">Special Issue: March 30, 2026</p>
                    </div>
                    <h1 class="text-5xl text-center my-4 font-black italic tracking-tighter leading-none" style="font-family: 'Playfair Display', serif;">The Ledger</h1>
                    
                    <div class="space-y-4 text-justify leading-relaxed relative z-10" style="font-family: 'EB Garamond', serif;">
                        <p class="nyt-lead text-[1.2rem]">
                            Tepat pada koordinat waktu yang telah ditentukan, <b>sayangku</b> secara resmi memasuki fase kedewasaan ke-17 tahun, menandai berakhirnya sebuah era dan dimulainya babak baru yang lebih krusial.
                        </p>
                        <p class="text-[1rem]">Laporan intelijen ini bukan sekadar arsip rutin, melainkan bukti otentik dari perjalanan panjang yang penuh makna. <b>Tujuh belas tahun</b> bukanlah sekadar angka dalam kalender, melainkan akumulasi dari setiap tawa, mimpi, dan keberanian yang telah kamu bentuk dengan indah, <b>sayangku</b>.</p>
                    </div>
                </div>

                <div class="relative mt-6 mx-4 z-10">
                    <div class="notebook-paper transform rotate-2">
                        <div class="washi-tape washi-blue" style="top: -10px; left: -10px; transform: rotate(-45deg); width: 50px;"></div>
                        <div class="quote-block !m-0 !bg-transparent !border-none !p-0">
                            "Beberapa jiwa bersinar terlalu terang untuk sekadar dilewatkan oleh waktu; mereka adalah naskah yang ditulis oleh takdir."
                        </div>
                    </div>
                </div>
                
                <div class="mt-auto mb-8 p-4 relative z-10">
                    <div class="torn-paper torn-top p-4 bg-white rotate-1 shadow-md">
                        <div class="paperclip" style="top: -20px; right: 20px; transform: rotate(15deg);"></div>
                        <p class="text-[1rem] font-serif text-justify">Statusmu kini telah ditingkatkan menjadi <b>aset paling berharga</b> dalam sejarah operasional hidupku. Ketahuilah bahwa di setiap detak waktu yang berlalu, <b>sayangku</b> akan selalu menjadi pusat dari segala koordinat kebahagiaanku. Selamat datang di gerbang baru kehidupan.</p>
                        <div class="mt-4 border-t border-dashed border-black/30 pt-2 text-right">
                            <span class="scrap-text text-[8px]">REF: OPR-17-SWEET</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Halaman 1: Evidence -->
            <section class="page-module victorian-bg" id="mod-1">
                <div class="grid-paper shadow-2xl rotate-[1deg] !h-auto mb-4 mt-6 mx-2 relative z-10">
                    <div class="washi-tape washi-yellow" style="top: -10px; right: 20px; transform: rotate(15deg); width: 80px;"></div>
                    <div class="washi-tape" style="bottom: -10px; left: 20px; transform: rotate(-15deg); width: 80px;"></div>
                    
                    <div class="absolute top-[-20px] right-[-10px] z-30">
                        <div class="polaroid w-28 rotate-[5deg]">
                            <div class="pushpin" style="top: 5px; left: 50%; transform: translateX(-50%);"></div>
                            <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/Desain%20tanpa%20judul_20250821_003903_0000.jpg" alt="Sayangku">
                            <div class="polaroid-caption">Target Acquired</div>
                        </div>
                    </div>
                    
                    <div class="form-header border-b-2 border-black mb-4 pb-1 w-2/3">
                        <div class="text-[14px] font-black uppercase tracking-[0.1em] text-black font-serif">CONFIDENTIAL FILE</div>
                        <div class="text-[8px] font-mono">CASE ID: 017/AF-MAR</div>
                    </div>

                    <div class="mt-2 space-y-2 pr-[95px] font-mono text-[10px]">
                        <div class="bg-white/50 p-1 border-b border-dotted border-black/30 flex justify-between">
                            <span class="font-bold text-gray-500">SUBJECT:</span>
                            <span class="font-bold">ARISTIA FIRLIN</span>
                        </div>
                        <div class="bg-white/50 p-1 border-b border-dotted border-black/30 flex justify-between">
                            <span class="font-bold text-gray-500">CLASS:</span>
                            <span class="font-bold text-red-800">S-TIER ASSET</span>
                        </div>
                        <div class="bg-white/50 p-1 border-b border-dotted border-black/30 flex justify-between">
                            <span class="font-bold text-gray-500">AGE:</span>
                            <span class="font-bold">17 YEARS</span>
                        </div>
                        <div class="bg-white/50 p-1 border-b border-dotted border-black/30 flex justify-between">
                            <span class="font-bold text-gray-500">ORIGIN:</span>
                            <span class="font-bold">30/03/2009</span>
                        </div>
                    </div>
                    
                    <div class="mt-6 relative">
                        <div class="newspaper-fragment" style="top: -15px; left: -15px; transform: rotate(-5deg); z-index: 10;">
                            <h4>EVIDENCE #1</h4>
                            <p>Rekaman visual terenkripsi.</p>
                        </div>
                        <div class="bg-black/[0.04] p-3 border-2 border-dashed border-black/20 rounded-sm relative group bg-white">
                            <div class="flex justify-between items-center mb-2">
                                <p class="text-[8px] font-bold uppercase opacity-50">Encrypted Signal:</p>
                                <span class="text-[7px] font-mono text-red-800 bg-red-100 px-1 border border-red-200">LOCKED</span>
                            </div>
                            
                            <div id="video-container" class="hidden transition-all duration-500 ease-in-out">
                                <video controls class="w-full border border-black/10 shadow-sm" style="max-height: 120px; object-fit: cover;">
                                    <source src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/VID_20250808204246202.mp4" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>

                            <button id="decrypt-btn" onclick="document.getElementById('video-container').classList.remove('hidden'); this.style.display='none';" class="w-full py-3 border border-dashed border-black/30 bg-[#f0f0f0] hover:bg-white transition-colors flex flex-col items-center justify-center gap-1 cursor-pointer">
                                <span class="text-[9px] font-bold uppercase tracking-widest text-gray-700">Tap to Decrypt</span>
                            </button>
                        </div>
                    </div>

                    <div class="mt-4 p-2 bg-yellow-50 border border-yellow-100 text-justify relative">
                        <div class="washi-tape washi-pattern" style="top: -5px; left: 40%; width: 60px; height: 15px;"></div>
                        <p class="text-[9px] leading-relaxed text-gray-800 font-serif italic">
                            "Subjek menunjukkan perkembangan emosional yang signifikan. Prioritas pengawasan: MUTLAK."
                        </p>
                    </div>
                    
                    <div class="stamp-container-v2 mt-4">
                        <div class="round-stamp opacity-80 rotate-[-10deg]">
                            VERIFIED<br>BY N.<br>SECURE
                        </div>
                        <img src="https://img.icons8.com/ios/100/000000/fingerprint.png" class="fingerprint-zone opacity-40" alt="Fingerprint">
                        <div class="barcode-strip opacity-30"></div>
                    </div>
                </div>
            </section>

            <!-- Halaman 2: Clipping (New) -->
            <section class="page-module victorian-bg" id="mod-2">
                <h2 class="text-center font-bold text-[10px] uppercase mb-6 border-b pb-2 tracking-[0.2em]">Digital Clipping: Ext. Source</h2>
                
                <div class="relative bg-white p-2 shadow-lg rotate-1 border border-gray-300 mt-4 mx-2">
                    <div class="washi-tape washi-blue" style="top: -10px; left: 10%; transform: rotate(-2deg); width: 80px;"></div>
                    <div class="washi-tape washi-yellow" style="bottom: -10px; right: 10%; transform: rotate(2deg); width: 80px;"></div>
                    <div class="border border-black/10 p-4 bg-gray-50">
                        <p class="text-[8px] font-bold uppercase mb-3 text-center opacity-60 tracking-widest">Intercepted Signal: Instagram</p>
                        <a href="https://www.instagram.com/reel/DQEbbnuEj95/?igsh=MXJ0ejJ5amxsZW1y" target="_blank" class="block group relative overflow-hidden border border-black/20">
                            <div class="aspect-video bg-black/5 flex items-center justify-center group-hover:bg-black/10 transition-colors">
                                <div class="w-12 h-12 rounded-full bg-white/90 flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-pink-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                    </svg>
                                </div>
                                <span class="absolute bottom-2 text-[8px] font-bold bg-white/90 px-2 py-0.5 rounded-sm shadow-sm">TAP TO VIEW REEL</span>
                            </div>
                        </a>
                        <div class="mt-3 text-justify">
                            <p class="text-[9px] font-serif italic leading-relaxed text-gray-600">
                                "Visual evidence intercepted from public channels. Subject appears in high spirits. Archiving for sentimental analysis."
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 grid grid-cols-3 gap-4">
                    <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/images.jpeg" class="w-full h-auto rounded-md shadow-lg transform rotate-[-3deg] hover:scale-105 transition-transform" alt="Postcard from Japan">
                    <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/1196-front-661x1024.jpg" class="w-full h-auto rounded-md shadow-lg transform rotate-[2deg] hover:scale-105 transition-transform" alt="Postcard from Paris">
                    <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/images%20(1).jpeg" class="w-full h-auto rounded-md shadow-lg transform rotate-[-1deg] hover:scale-105 transition-transform" alt="Postcard from New York">
                </div>
            </section>

            <!-- Halaman 3: Calendar (Shifted) -->
            <section class="page-module victorian-bg" id="mod-3">
                <audio id="applause-sfx" src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/Applause%20Sound%20Effect%28MP3_320K%29.mp3" preload="auto"></audio>
                <h2 class="text-center font-bold text-[10px] uppercase mb-4 border-b pb-2 tracking-[0.2em] relative z-10">Logbook Operasional: Maret 2026</h2>
                
                <!-- Scrapbook Collage Area -->
                <div class="relative h-48 mb-4">
                    <!-- Mini Postcard Decoration -->
                    <div class="absolute top-2 left-2 w-24 h-16 bg-[#f4ebd0] border border-[#d3c5a3] shadow-md transform rotate-[-15deg] z-0 p-1 flex flex-col justify-between">
                        <div class="washi-tape washi-blue" style="top: -10px; left: -10px; transform: rotate(-30deg); width: 40px;"></div>
                        <div class="flex justify-between items-start border-b border-double border-[#d3c5a3] pb-1">
                            <span class="text-[4px] font-serif uppercase text-[#8b0000]">Postcard</span>
                            <div class="w-3 h-4 border border-dashed border-[#d3c5a3]"></div>
                        </div>
                        <div class="flex-1 flex flex-col justify-center gap-1 mt-1">
                            <div class="border-b border-[#d3c5a3] w-full"></div>
                            <div class="border-b border-[#d3c5a3] w-full"></div>
                            <div class="border-b border-[#d3c5a3] w-3/4"></div>
                        </div>
                    </div>

                    <!-- Background Scraps -->
                    <div class="newspaper-fragment" style="top: 10px; left: 20px; transform: rotate(-8deg); z-index: 5;">
                        <h4>DAILY CHRONICLE</h4>
                        <p>Laporan cuaca menunjukkan kondisi cerah pada tanggal 30. Persiapan perayaan telah mencapai tahap akhir.</p>
                    </div>
                    <div class="newspaper-fragment" style="bottom: 20px; right: -5px; transform: rotate(5deg); width: 120px; background: #dcd0c0;">
                        <h4>ARCHIVE 017</h4>
                        <p>Dokumen rahasia ini diklasifikasikan sebagai prioritas utama. Jangan disebarluaskan tanpa izin otoritas tertinggi.</p>
                    </div>

                    <!-- Main Photo Clipping -->
                    <div class="absolute top-4 left-1/2 transform -translate-x-1/2 rotate-2 z-10">
                        <div class="polaroid w-32">
                            <div class="pushpin" style="top: 5px; left: 50%; transform: translateX(-50%);"></div>
                            <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/IMG-20250502-WA0070.jpg" alt="Featured Memory">
                            <div class="polaroid-caption">March 30th</div>
                        </div>
                    </div>

                    <!-- Decorative Stickers/Stamps -->
                    <div class="absolute top-0 right-4 w-12 h-12 border-2 border-red-800 rounded-full flex items-center justify-center transform rotate-12 opacity-70 z-20">
                        <span class="text-[6px] font-bold text-red-800 text-center leading-tight">MARCH<br>30<br>2026</span>
                    </div>
                </div>

                <div id="calendar-grid" class="grid grid-cols-7 gap-1 text-[11px] text-center p-4 bg-white/50 border border-black/10 relative z-10 shadow-sm">
                    <!-- Calendar injected by JS -->
                </div>
                
                <div class="radar-box relative z-10 bg-[#f2ecd9]/80 backdrop-blur-sm p-2 mt-4 border border-black/5">
                    <div class="monitor-line">
                        <div class="wave-pulse"></div>
                    </div>
                    <div class="data-readout uppercase mt-2">
                        <div>Target: Aristia F.</div>
                        <div>Coord: 30.0326.N</div>
                        <div>Status: Critical Path</div>
                        <div>Signal: Strong 100%</div>
                    </div>
                    <p class="text-[7px] opacity-60 mt-2 text-justify font-serif italic">
                        "Pemantauan transmisi otomatis diaktifkan. Seluruh sistem sinkron dengan detak waktu target."
                    </p>
                </div>
            </section>

            <!-- Halaman 4: Surprise (Shifted) -->
            <section class="page-module" id="mod-4">
                <audio id="birthday-song" src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/gemini_generated_media_e9d2356c.mp3" preload="auto"></audio>
                <div id="candle-stage">
                    <div class="candle">
                        <div class="candle-glow"></div>
                        <div class="flame" onclick="DossierSystem.extinguish()"></div>
                    </div>
                    <p class="candle-hint">Tap flame to initiate</p>
                </div>
                
                <div class="notebook-paper shadow-lg h-full relative rotate-1 mx-2 mt-4 z-10">
                    <div class="washi-tape washi-pattern" style="top: -15px; left: 50%; transform: translateX(-50%) rotate(2deg); width: 100px;"></div>
                    <div class="washi-tape washi-blue" style="bottom: -15px; right: 20px; transform: rotate(-5deg); width: 80px;"></div>
                    
                    <div class="flex justify-between items-end mb-8 opacity-60 border-b border-black/10 pb-2">
                        <h2 class="text-[9px] font-bold uppercase tracking-widest font-serif text-red-900">Internal Memo: Confidential</h2>
                        <span class="text-[8px] font-mono bg-black/5 px-1">LOG-ID: 300326</span>
                    </div>
                    
                    <div id="typewriter-output" class="relative z-10"></div>

                    <!-- Tarot Card Decorations -->
                    <div class="tarot-card" style="top: 20px; left: -40px; transform: rotate(-15deg);">
                        <img id="tarot-lovers" src="https://picsum.photos/seed/lovers/60/100" alt="The Lovers">
                        <div class="tarot-label">The Lovers</div>
                    </div>
                    <div class="tarot-card" style="top: 140px; left: -35px; transform: rotate(-5deg);">
                        <img id="tarot-star" src="https://picsum.photos/seed/star/60/100" alt="The Star">
                        <div class="tarot-label">The Star</div>
                    </div>
                    <div class="tarot-card" style="top: 80px; right: -40px; transform: rotate(12deg);">
                        <img id="tarot-moon" src="https://picsum.photos/seed/moon/60/100" alt="The Moon">
                        <div class="tarot-label">The Moon</div>
                    </div>
                    
                    <div id="wax-seal-area" class="wax-seal-decoration mt-auto">
                        <div class="newspaper-fragment" style="bottom: 10px; left: -10px; transform: rotate(5deg); width: 80px; z-index: 0;">
                            <h4>VERIFIED</h4>
                            <p>Otentikasi biometrik selesai.</p>
                        </div>
                        
                        <div class="relative z-10 flex flex-col items-center">
                            <div class="red-ribbon shadow-sm"></div>
                            <div class="wax-seal shadow-md"></div>
                            <div class="verification-grid mt-4 bg-white/50 p-2 border border-black/5">
                                <div class="bio-info">
                                    <div class="bio-row">AUTH: <span class="bio-val">OPR_N</span></div>
                                    <div class="bio-row">SESS: <span class="bio-val">AF-17</span></div>
                                    <div class="bio-row">SIG: <span class="bio-val">ENCR</span></div>
                                </div>
                                <div class="retro-qr-graphic opacity-60"></div>
                            </div>
                        </div>
                        
                        <div class="footer-shred mt-4"></div>
                        <p class="text-[7px] opacity-30 uppercase tracking-[0.4em] -mt-2 text-center">Official Archive Termination</p>
                        

                    </div>
                </div>
            </section>

            <!-- Halaman 7: Postcard Scrapbook (New) -->
            <section class="page-module victorian-bg" id="mod-7">
                <div id="lyrics-overlay" class="lyrics-overlay hidden"></div>
                <video id="hidden-greeting" src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/Hindia%20-%20everything%20u%20are%20edit(720P_HD).mp4" class="hidden absolute inset-0 w-full h-full object-cover z-[100]" preload="auto" onclick="this.pause(); this.classList.add('hidden'); DossierSystem.stopSparkles();"></video>
                <div class="relative h-full w-full">
                    
                    <!-- Postcard Background -->
                    <div class="absolute top-4 left-2 right-2 bg-[#f4ebd0] p-3 shadow-md transform rotate-[-2deg] border border-[#d3c5a3]">
                        <!-- Postcard Header -->
                        <div class="flex justify-between items-start border-b-2 border-double border-[#d3c5a3] pb-2 mb-2">
                            <div class="text-[8px] font-serif uppercase tracking-widest text-[#8b0000]">Carte Postale</div>
                            <div class="w-8 h-10 border border-dashed border-[#d3c5a3] flex items-center justify-center text-[6px] text-gray-400 text-center">Place<br>Stamp<br>Here</div>
                        </div>
                        
                        <!-- Postcard Content Area -->
                        <div class="flex gap-2">
                            <!-- Left: Photo -->
                            <div class="w-1/2 relative cursor-pointer group z-[50]" onclick="event.stopPropagation(); DossierSystem.playPostcardExperience()" title="Tap to play memory">
                                <div class="tape-strip" style="top: -5px; left: -5px; transform: rotate(-15deg); width: 30px;"></div>
                                <div class="tape-strip" style="bottom: -5px; right: -5px; transform: rotate(15deg); width: 30px;"></div>
                                <img src="https://urcxbufxcebfgrsfvmsj.supabase.co/storage/v1/object/public/my%20pacar/IMG-20250504-WA0073.jpg" class="w-full h-auto border-4 border-white shadow-sm filter sepia-[0.1] group-hover:sepia-0 transition-all duration-500" alt="Sweet Memory">
                                <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                    <div class="bg-white/80 rounded-full p-2 shadow-lg">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-red-800" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Right: Message & Audio -->
                            <div class="w-1/2 flex flex-col justify-between">
                                <div class="space-y-2 mt-2">
                                    <div class="border-b border-[#d3c5a3] text-[6px] font-serif italic text-[#8b0000] pt-1">Dearest,</div>
                                    <div class="border-b border-[#d3c5a3] text-[6px] font-serif italic text-[#5a4a42] pt-1">Selamat ulang tahun yang ke-17.</div>
                                    <div class="border-b border-[#d3c5a3] text-[6px] font-serif italic text-[#5a4a42] pt-1">Semoga harimu seindah</div>
                                    <div class="border-b border-[#d3c5a3] text-[6px] font-serif italic text-[#5a4a42] pt-1">senyumanmu.</div>
                                    <div class="border-b border-[#d3c5a3] text-[6px] font-serif italic text-[#8b0000] text-right pt-1">Love, N</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Decorative Scraps -->
                    <div class="newspaper-fragment" style="bottom: 10%; left: 5%; transform: rotate(-10deg); z-index: 10;">
                        <h4>MEMORIES</h4>
                        <p>Tersimpan rapi dalam arsip waktu.</p>
                    </div>
                    
                    <div class="absolute bottom-5 right-5 transform rotate-12 z-10">
                        <div class="w-10 h-10 rounded-full border-2 border-red-800 flex items-center justify-center bg-transparent">
                            <span class="text-[8px] font-bold text-red-800 uppercase transform -rotate-12">Love</span>
                        </div>
                    </div>
                    
                    <!-- Cute Sticker -->
                    <div class="absolute top-2 right-10 transform rotate-12 z-20 opacity-80">
                        <img src="https://img.icons8.com/color/48/000000/hearts.png" width="24" alt="Heart Sticker">
                    </div>
                </div>
            </section>

            <!-- Halaman 5: Chat Terminal (Shifted) -->
            <section class="page-module" id="mod-5">
                <div class="torn-paper p-1 bg-[#f0f0f0] shadow-2xl h-full flex flex-col rotate-[0.5deg]">
                    <div class="tape-strip" style="top: -10px; left: 10px; transform: rotate(-10deg);"></div>
                    <div class="tape-strip" style="top: -10px; right: 10px; transform: rotate(10deg);"></div>
                    
                    <div class="bg-[#1a1a1a] text-green-500 p-4 flex-1 flex flex-col font-mono text-[10px] relative overflow-hidden border-4 border-gray-300 shadow-inner">
                        <!-- CRT Scanline Overlay -->
                        <div class="absolute inset-0 pointer-events-none opacity-10 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,3px_100%] z-20"></div>
                        
                        <div class="flex justify-between items-center mb-4 border-b border-green-900/50 pb-2 relative z-30">
                            <h2 class="font-bold uppercase tracking-widest animate-pulse">Terminal Comms</h2>
                            <button onclick="DossierSystem.openModal()" class="text-red-500 hover:text-red-400 font-bold uppercase underline decoration-dotted">Purge Logs</button>
                        </div>
                        
                        <div id="msg-display" class="relative z-30 flex-1 overflow-y-auto space-y-2 pr-2 scrollbar-thin scrollbar-thumb-green-900 scrollbar-track-transparent"></div>
                        
                        <div class="mt-4 pt-4 border-t border-green-900/50 relative z-30">
                            <div class="identity-toggle mb-2 border border-green-900/30 inline-flex">
                                <div id="btn-n" onclick="DossierSystem.setSender('N')" class="toggle-btn text-green-500 hover:bg-green-900/20 active">OPR_N</div>
                                <div id="btn-aristia" onclick="DossierSystem.setSender('Aristia')" class="toggle-btn text-green-500 hover:bg-green-900/20">SUB_A</div>
                            </div>
                            <div class="flex gap-2">
                                <input type="text" id="msg-field" placeholder="Input transmission..." class="flex-1 bg-black border-b border-green-700 text-green-400 outline-none py-2 px-1 placeholder-green-900" autocomplete="off">
                                <button onclick="DossierSystem.send()" class="bg-green-900/30 text-green-400 border border-green-700 px-4 py-2 uppercase font-bold hover:bg-green-900/50 transition-colors">Send</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="absolute -bottom-8 left-0 w-full flex justify-center">
                        <div class="newspaper-fragment transform rotate-[-2deg] shadow-lg">
                            <h4>SYSTEM STATUS</h4>
                            <p>Koneksi aman. Enkripsi end-to-end aktif.</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>


        <footer class="p-4 border-t border-black/5 flex justify-between items-center text-[8px] opacity-40 font-bold tracking-widest uppercase">
            <div class="flex items-center">
                <span id="back-nav-btn" onclick="DossierSystem.prev()">[ BACK ]</span>
                <span>Dossier Cryptography v1.15</span>
            </div>
            <span id="center-stamp">AUTHORIZED ACCESS ONLY</span>
            <span id="page-num">1 / 5</span>
        </footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Inline Supabase Config for portability
        const SUPABASE_URL = 'https://urcxbufxcebfgrsfvmsj.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVyY3hidWZ4Y2ViZmdyc2Z2bXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NzExMTYsImV4cCI6MjA4NzI0NzExNn0.CoWpvdB4v27SAWEni48Wu0JQcSMebRoZCPppnJNlLmQ';
        const TABLE_NAME = 'messages';
        
        let supabaseClient = null;
        try {
            if (typeof supabase !== 'undefined') {
                supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log("Supabase initialized");
            } else {
                console.warn("Supabase library not loaded (offline mode)");
            }
        } catch (e) {
            console.error("Supabase init failed:", e);
        }

        console.log("DossierSystem script loading...");
        
        // Define DossierSystem in global scope
        window.DossierSystem = {
            index: 0,
            currentSender: 'N',
            isTyping: false,
            candleBlown: false,
            lyricsInterval: null,

            fadeIn(audioId, duration = 2000) {
                const audio = document.getElementById(audioId);
                if (!audio) return;
                if (audio.fadeInterval) clearInterval(audio.fadeInterval);
                
                audio.volume = 0;
                audio.play().catch(e => console.warn("Playback blocked or failed:", e));
                
                const step = 0.05;
                const interval = duration * step;
                
                audio.fadeInterval = setInterval(() => {
                    if (audio.volume < 1 - step) {
                        audio.volume += step;
                    } else {
                        audio.volume = 1;
                        clearInterval(audio.fadeInterval);
                        audio.fadeInterval = null;
                    }
                }, interval);
            },

            fadeOut(audioId, duration = 2000) {
                const audio = document.getElementById(audioId);
                if (!audio || audio.paused) return;
                if (audio.fadeInterval) clearInterval(audio.fadeInterval);
                
                const step = 0.05;
                const interval = duration * step;
                
                audio.fadeInterval = setInterval(() => {
                    if (audio.volume > step) {
                        audio.volume -= step;
                    } else {
                        audio.volume = 0;
                        audio.pause();
                        audio.currentTime = 0;
                        clearInterval(audio.fadeInterval);
                        audio.fadeInterval = null;
                    }
                }, interval);
            },

            playPostcardExperience() {
                const video = document.getElementById('hidden-greeting');
                const overlay = document.getElementById('lyrics-overlay');
                if (!video) {
                    console.error("Video element 'hidden-greeting' not found!");
                    return;
                }
                if (overlay) {
                    overlay.classList.remove('hidden');
                    overlay.classList.add('active');
                }
                video.classList.remove('hidden');
                video.play().catch(e => console.warn("Playback blocked or failed:", e));
                this.startSparkles();
            },

            stopSparkles() {
                const existing = document.querySelectorAll('.sparkle');
                existing.forEach(s => s.remove());
                const overlay = document.getElementById('lyrics-overlay');
                if (overlay) {
                    overlay.classList.remove('active');
                    overlay.classList.add('hidden');
                }
            },

            startSparkles() {
                this.stopSparkles(); // Clear any existing ones
                const container = document.getElementById('lyrics-overlay');
                for (let i = 0; i < 15; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = `${Math.random() * 100}%`;
                    sparkle.style.top = `${Math.random() * 80 + 20}%`; // Start lower down
                    sparkle.style.animationDelay = `${Math.random() * 3}s`;
                    sparkle.style.animationDuration = `${Math.random() * 2 + 3}s`; // Vary duration
                    container.appendChild(sparkle);
                }
            },

            async generateTarotCards() {
                // Using static tarot images for reliability and pure HTML/JS experience
                const cards = [
                    { id: 'tarot-lovers', seed: 'lovers' },
                    { id: 'tarot-star', seed: 'star' },
                    { id: 'tarot-moon', seed: 'moon' }
                ];

                for (const card of cards) {
                    const el = document.getElementById(card.id);
                    if (el) {
                        // Using Picsum with specific seeds to simulate tarot card imagery
                        el.src = `https://picsum.photos/seed/${card.seed}/300/400`;
                    }
                }
            },

            init() {
                this.generateTarotCards();
                // Calendar Injection
                const cal = document.getElementById('calendar-grid');
                const days = ['S','S','R','K','J','S','M'];
                days.forEach(d => {
                    const div = document.createElement('div');
                    div.className = 'font-bold opacity-30 mb-2';
                    div.innerText = d;
                    cal.appendChild(div);
                });
                for(let i=1; i<=31; i++) {
                    const div = document.createElement('div');
                    div.className = 'p-2 transition-all duration-300 hover:bg-red-900/10 hover:scale-110 cursor-default rounded-sm';
                    if (i === 30) {
                        div.className += ' date-highlight cursor-pointer relative group';
                        div.innerHTML = `
                            ${i}
                            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-32 bg-red-900 text-white text-[8px] p-2 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50">
                                Target Date Reached! Happy 17th Birthday, sayangku! ‚ù§Ô∏è
                                <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-red-900"></div>
                            </div>
                            <div class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 text-[6px] text-red-800 font-bold animate-bounce whitespace-nowrap">TAP ME</div>
                        `;
                        div.onclick = () => {
                            DossierSystem.fadeIn('applause-sfx', 500);
                            alert("Sistem mendeteksi anomali kebahagiaan yang ekstrim pada tanggal ini. Selamat ulang tahun sayangku! üéâ");
                        };
                    } else {
                        div.innerText = i;
                    }
                    cal.appendChild(div);
                }

                // PIN listener moved to DOMContentLoaded for robustness
                // document.getElementById('pin-field').oninput = ...
                
                if (supabaseClient) {
                    supabaseClient.channel('messages_channel')
                        .on('postgres_changes', { event: '*', schema: 'public', table: TABLE_NAME }, () => this.loadMsgs())
                        .subscribe();
                } else {
                    console.warn("Supabase client not available, skipping real-time subscription");
                }
                
                this.render();
                document.getElementById('msg-field').addEventListener('keypress', (e) => { if(e.key==='Enter') this.send(); });

                // Tape Interaction
                document.querySelectorAll('.tape-strip, .washi-tape').forEach(tape => {
                    tape.addEventListener('click', (e) => {
                        const msgs = ["Secret Found!", "XOXO", "Love You", "Top Secret", "Don't Peel!"];
                        const msg = msgs[Math.floor(Math.random() * msgs.length)];
                        
                        const note = document.createElement('div');
                        note.className = 'hidden-note';
                        note.innerText = msg;
                        note.style.left = (e.clientX - 20) + 'px';
                        note.style.top = (e.clientY - 30) + 'px';
                        note.style.display = 'block';
                        document.body.appendChild(note);
                        
                        setTimeout(() => note.remove(), 2000);
                    });
                });
                console.log("DossierSystem initialized");
            },

            showPin() {
                console.log("Access Archive button clicked");
                document.getElementById('init-screen').style.display = 'none';
                document.getElementById('pin-screen').style.display = 'block';
                document.getElementById('pin-field').focus();
            },

            runConstellationTransition() {
                const loader = document.getElementById('constellation-loader');
                loader.style.display = 'flex';
                setTimeout(() => loader.style.opacity = '1', 10);
                setTimeout(() => {
                    loader.style.opacity = '0';
                    this.unlock();
                    setTimeout(() => loader.style.display = 'none', 500);
                }, 2500);
            },

            unlock() {
                const authModule = document.getElementById('auth-module');
                authModule.style.opacity = '0';
                setTimeout(() => { authModule.style.display = 'none'; }, 800);
            },

            setSender(name) {
                this.currentSender = name;
                document.getElementById('btn-n').classList.toggle('active', name === 'N');
                document.getElementById('btn-aristia').classList.toggle('active', name === 'Aristia');
            },

            render() {
                // Audio Fade Out Logic
                if (this.index !== 4) this.fadeOut('birthday-song', 1500);
                if (this.index !== 5) {
                    const video = document.getElementById('hidden-greeting');
                    if (video) {
                        video.pause();
                        video.currentTime = 0;
                        video.classList.add('hidden');
                    }
                    this.stopSparkles();
                }
                if (this.index !== 3) this.fadeOut('applause-sfx', 500);

                document.querySelectorAll('.page-module').forEach((m, i) => m.classList.toggle('active', i === this.index));
                document.getElementById('page-num').innerText = `${this.index + 1} / 7`;
                
                const backBtn = document.getElementById('back-nav-btn');
                const centerStamp = document.getElementById('center-stamp');

                if (this.index === 6) { // Chat Page is now at index 6
                    this.loadMsgs();
                }
                
                if (this.index === 5) { // Postcard page is at index 5
                    backBtn.style.display = 'inline-block';
                    centerStamp.style.display = 'none';
                } else {
                    backBtn.style.display = 'none';
                    centerStamp.style.display = 'inline-block';
                }

                if(this.index === 4 && !this.candleBlown) {
                    document.getElementById('candle-stage').style.display = 'flex';
                    document.getElementById('candle-stage').style.opacity = '1';
                }
            },

            extinguish() {
                const flash = document.getElementById('flash-overlay');
                flash.classList.add('flash-active');
                this.fadeIn('birthday-song');
                
                setTimeout(() => {
                    document.getElementById('candle-stage').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('candle-stage').style.display = 'none';
                        this.candleBlown = true;
                        this.type();
                    }, 1000);
                    flash.classList.remove('flash-active');
                }, 400); 
            },

            next() { if(this.index < 6) { this.index++; this.render(); } },
            prev() { if(this.index > 0) { this.index--; this.render(); } },

            type() {
                if(this.isTyping) return;
                this.isTyping = true;
                const out = document.getElementById('typewriter-output');
                const seal = document.getElementById('wax-seal-area');
                const page3 = document.getElementById('mod-4');
                const txt = "Kepada Aset Berharga,\n\nDi hari yang luar biasa spesial ini, aku ingin kamu tahu betapa berartinya setiap detik kehadiranmu bagi duniaku. Selamat ulang tahun yang ke-17, sayangku.\n\nTujuh belas adalah awal dari petualangan yang lebih dewasa, lebih menantang. Aku akan tetap di sini, di sisimu, memastikan setiap memori kita tersimpan dengan aman dalam arsip rahasia ini.\n\nTetaplah bersinar, tetaplah menjadi dirimu yang luar biasa. Happy 17th Birthday, Aristia Firlin.\n\nSelamanya milikmu,\nN.";
                out.innerText = ""; 
                let i = 0;
                seal.classList.remove('seal-active');

                const intrvl = setInterval(() => {
                    out.innerText += txt[i]; 
                    i++;
                    if(i >= txt.length) { 
                        clearInterval(intrvl); 
                        this.isTyping = false;
                        setTimeout(() => { 
                            page3.classList.add('victorian-bg'); 
                            seal.classList.add('seal-active'); 
                        }, 500);
                    }
                }, 50); 
            },

            async loadMsgs() {
                if (!supabaseClient) return;
                try {
                    const { data, error } = await supabaseClient.from(TABLE_NAME).select('*').order('created_at', { ascending: true });
                    if (error) throw error;
                    this.renderMsgs(data);
                } catch (err) {
                    console.error('loadMsgs failed:', err);
                }
            },

            renderMsgs(data) {
                const box = document.getElementById('msg-display');
                if(!box) return;
                box.innerHTML = (data && data.length > 0) ? data.map(m => `
                    <div class="message-bubble ${m.sender === 'N' ? 'msg-n' : 'msg-aristia'}">
                        <span class="block text-[6px] font-bold opacity-40 mb-1 uppercase">${m.sender}</span>
                        <div>${m.content}</div>
                    </div>
                `).join('') : '<p class="text-center opacity-20 py-10 italic text-[9px]">Channel empty.</p>';
                box.scrollTop = box.scrollHeight;
            },

            async send() {
                const f = document.getElementById('msg-field');
                if(!f || !f.value.trim()) return;
                const content = f.value.trim();
                f.value = '';
                
                if (!supabaseClient) {
                    alert("Offline mode: Cannot send messages.");
                    return;
                }

                try {
                    await supabaseClient.from(TABLE_NAME).insert([{ content: content, sender: this.currentSender }]);
                    this.loadMsgs();
                } catch (err) {
                    console.error('send() error:', err);
                }
            },

            openModal() { document.getElementById('delete-modal').style.display = 'flex'; },
            closeModal() { document.getElementById('delete-modal').style.display = 'none'; },

            async confirmPurge() {
                if (confirm("WARNING: Permanent deletion of all transmission logs. Proceed?")) {
                    if (!supabaseClient) return;
                    try {
                        await supabaseClient.from(TABLE_NAME).delete().neq('id', -1);
                        this.loadMsgs(); 
                        this.closeModal();
                    } catch(e) {
                        console.error("Purge error", e);
                    }
                }
            }
        };

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM ready, initializing DossierSystem...");
            
            // Setup PIN listener immediately
            const pinField = document.getElementById('pin-field');
            if (pinField) {
                pinField.oninput = (e) => {
                    if(e.target.value === "300326") window.DossierSystem.runConstellationTransition();
                };
                console.log("PIN listener attached");
            } else {
                console.error("PIN field not found!");
            }

            // Initialize system
            window.DossierSystem.init();
        });
    </script>
  </body>
</html>

